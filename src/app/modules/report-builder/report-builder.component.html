<ng-template [ngIf]="reportLoaded && authService.authServiceLoaded">
    <div class="container-fluid">
        <div class="row">
            <div class="col" style="margin: 10px auto;">
                <h4>Generate Report</h4>

            </div>
        </div>
        <div class="row">
            <mat-card style="width: 98%; margin: .5% auto;">
                <mat-card-content>
                    <div class="col">
                        <p style="font-size: 16px; text-align: center;">
                            Step 1: Please select your Company from the drop-down menu. After selecting a Company,
                            please select a scenario for which the Report will be generated.
                        </p>

                        <div class="row">
                            <div class="col-2"></div>
                            <div class="col-4 centerAlign">
                                <form class="example-form">
                                    <mat-form-field style="width: 100%; margin-left: 20px;">
                                        <mat-label>Select Company</mat-label>
                                        <input type="text" matInput [formControl]="myControl"
                                            [matAutocomplete]="autoOne">
                                        <mat-autocomplete #autoOne="matAutocomplete" [displayWith]="displayFn">
                                            <mat-option *ngFor="let comp of filteredOptions | async" [value]="option"
                                                (click)="loadCompany(comp)">
                                                {{comp.compName }}
                                            </mat-option>
                                        </mat-autocomplete>
                                        <span matSuffix>
                                            <mat-icon>search</mat-icon>
                                        </span>
                                    </mat-form-field>
                                </form>
                            </div>
                            <div class="col-4 centerAlign">
                                <mat-form-field style="width: 100%; margin-left: 20px;">
                                    <mat-select name="model" [(ngModel)]="selectedScenarioForDisplay">
                                        <mat-option [value]="-1" [disabled]="true">
                                            Select Scenario
                                        </mat-option>
                                        <ng-template ngFor [ngForOf]="selectedCompanyScenarios" let-scen
                                            let-scnIndex='index'>
                                            <mat-option [value]="scen" (click)="loadScenario(scen)">
                                                {{ "Scenario " + scen }}
                                            </mat-option>
                                        </ng-template>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-2"></div>

                        </div>

                        <!-- *ngIf = "showScenario" -->
                        <div class="row">
                            <div class="col-2"></div>


                            <div class="col-4 centerAlign" *ngIf='selectedCompany.compName'>
                                <span style="padding: 5px 10px; background-color: #164a5b; color: white;">
                                    Company Selected: {{ selectedCompany.compName }}
                                </span>
                            </div>
                            <div class="col-4 centerAlign" *ngIf="showScenario && selectedScenario >= 0 ">
                                <span style="padding: 5px 10px; background-color: #164a5b; color: white;">
                                    Scenario Selected: Scenario {{ selectedScenario }}
                                </span>
                            </div>
                            <div class="col-2"></div>
                        </div>

                        <p style="padding-top: 35px;
    font-size: 16px;
    text-align: center; margin: auto 12.7%;">Step 2: Please choose the specific financial statements and analyses that you would like to be
                            generated in your custom report. You can select specific pages from each module as well as
                            re-order them in a manner that best suits your reporting needs.</p>
                        <ng-template #itemTemplate let-item="item" let-index="index">
                            <!-- <span style="background-color: red;">{{index}}: {{item.value.name}}</span> -->
                            <mat-card style="margin: 2% auto; padding: 5px 20px; width: 60%; height: 60px;">
                                <mat-card-content [class.applyMargin]="rowIndex == reportSelection.length - 1 && false">
                                    <div class="row">
                                        <div class="col">
                                            <div class="row">
                                                <div class="col-1 autoMargin">
                                                    <span>
                                                        <mat-checkbox [(ngModel)]="item.value.isSelected">
                                                        </mat-checkbox>
                                                    </span>
                                                </div>
                                                <div class="col-4 autoMargin" style="font-size: 16px;">
                                                    <span> {{ item.value.name }} </span>
                                                </div>
                                                <div class="col">
                                                    <mat-form-field *ngIf='item.value.metrics'>
                                                        <mat-select name="model"
                                                            [(ngModel)]="item.value.selectedMetric.key">
                                                            <ng-template ngFor [ngForOf]="item.value.metrics"
                                                                let-metricType let-metricIndex='index'>
                                                                <mat-option [value]="metricType.key"
                                                                    (click)="loadSelectedMetric(item.value, metricType)">
                                                                    {{ metricType.name }}
                                                                </mat-option>
                                                            </ng-template>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-2 rightAlign">
                                                    <mat-icon style="margin: 20% 1px;">menu</mat-icon>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </mat-card-content>
                            </mat-card>
                        </ng-template>

                        <div class="row">
                            <div class="col">
                                <bs-sortable [(ngModel)]="reportSelection" [itemTemplate]="itemTemplate"
                                    itemClass="sortable-item" itemActiveClass="sortable-item-active"
                                    placeholderItem="Drag here" placeholderClass="placeholderStyle"
                                    wrapperClass="sortable-wrapper"></bs-sortable>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col"></div>
                            <div class="col centerAlign" style="margin: 15px auto;">
                                <button class="downloadReportBtn" mat-stroked-button mat-raised-button
                                    (click)="buildReport()">
                                    Download Report
                                </button>
                            </div>
                            <div class="col">

                            </div>
                        </div>

                    </div>
                </mat-card-content>
                <img id='imgToExport' #imagecanvas src='../../../assets/images/RMI_logo.jpg' style='display:none; border: none; box-shadow: none;'
                    >

                <img id='imgToExport' style="display:none; border: none; box-shadow: none; margin-top: 100px;" 
                 #imageOrganizational [src]='organizationLogo'>   

            </mat-card>
        </div>
    </div>
</ng-template>


<ng-template [ngIf]="!reportLoaded || !authService.authServiceLoaded">
    <div id="loader-container">
        <div id="loader"></div>
        <div>
            Loading Report&nbsp;.&nbsp;.&nbsp;.
        </div>
    </div>
</ng-template>


<ng-template [ngIf]="showValuations">
    <div class="container valuations" style="padding: 0; margin: 0; max-width: 100%; margin-top: 150px;" #firstBlock>
        <div class="row headers" style="
            font-weight: bold;
            background-color: #164a5b;
            color: white;
            max-width: 100%;
            padding: 18px 15px;
            font-weight: normal;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
          ">
          Weighted Average Cost of Capital
        </div>
  
        <div class="row" style="padding: 0; margin: 0; background: white">
          <div class="col" style="max-width: 50%; margin: 10px; padding: 0;">
            <div class="row headers" style="
                font-weight: bold;
                background-color: #164a5b;
                color: white;
                padding: 5px 15px;
                font-weight: normal;
                border-top-left-radius: 5px;
                border-top-right-radius: 5px;
              ">
              Capital Structure
            </div>
            <div class="row" style="background: white">
              <div class="col left-align">Debt to Total Capitalization</div>
              <div class="col-3 right-align">
                {{
                dcf.waac_calculations?.debt_to_total_cap * 100 | number: '1.2-2'
                }}
                %
                <mat-icon style="display: inline; margin: auto 5px; cursor: pointer" (click)="openPopUpModal(costOfDebt)">
                  edit</mat-icon>
              </div>
            </div>
            <div class="row" style="background: white">
              <div class="col left-align">Equity to Total Capitalization</div>
              <div class="col-3 right-align">
                {{
                dcf.waac_calculations?.equity_to_total_cap * 100
                | number: '1.2-2'
                }}
                %
              </div>
            </div>
            <div class="row highlight">
              <div class="col left-align" style="font-weight: bold">
                Debt / Equity
              </div>
              <div class="col-3 right-align" style="font-weight: bold">
                {{ dcf.waac_calculations?.debt_equity * 100 | number: '1.2-2' }}%
              </div>
            </div>
  
            <div class="row headers" style="
                font-weight: bold;
                background-color: #164a5b;
                color: white;
                padding: 5px 15px;
                font-weight: normal;
                border-top-left-radius: 5px;
                border-top-right-radius: 5px;
              ">
              Cost of Equity
            </div>
            <div class="row" style="background: white">
              <div class="col left-align">Risk Free Rate (10-Year Treasury)</div>
              <div class="col-3 right-align">
                {{
                dcf.waac_calculations?.risk_free_rate * 100 | number: '1.2-2'
                }}
                %
                <mat-icon style="display: inline; margin: auto 5px; cursor: pointer" (click)="openPopUpModal(costOfDebt)">
                  edit</mat-icon>
              </div>
            </div>
            <div class="row" style="background: white">
              <div class="col left-align">Equity Risk Premium</div>
              <div class="col-3 right-align">
                {{
                dcf.waac_calculations?.equity_risk_premium * 100
                | number: '1.2-2'
                }}
                %
                <mat-icon style="display: inline; margin: auto 5px; cursor: pointer" (click)="openPopUpModal(costOfDebt)">
                  edit</mat-icon>
              </div>
            </div>
            <div class="row" style="background: white">
              <div class="col left-align">Levered Beta</div>
              <div class="col-3 right-align">
                {{ dcf.waac_calculations?.levered_beta | number: '1.2-2' }}%
              </div>
            </div>
            <div class="row highlight">
              <div class="col left-align" style="font-weight: bold">
                Cost of Equity
              </div>
  
              <div class="col-3 right-align" style="font-weight: bold">
                {{
                dcf.waac_calculations?.cost_of_equity * 100 | number: '1.2-2'
                }}%
              </div>
            </div>
  
            <div class="row headers" style="
                font-weight: bold;
                background-color: #164a5b;
                color: white;
                padding: 5px 15px;
                font-weight: normal;
                border-top-left-radius: 5px;
                border-top-right-radius: 5px;
              ">
              Cost of Debt
            </div>
  
            <div class="row" style="background: white">
              <div class="col left-align">Cost of Debt</div>
              <div class="col-3 right-align">
                {{ dcf.waac_calculations?.cost_of_debt * 100 | number: '1.2-2' }}%
                <mat-icon style="display: inline; margin: auto 5px; cursor: pointer" (click)="openPopUpModal(costOfDebt)">
                  edit</mat-icon>
              </div>
            </div>
            <div class="row" style="background: white">
              <div class="col left-align">Tax Rate</div>
              <div class="col-3 right-align">
                {{ dcf.waac_calculations?.tax_rate * 100 | number: '1.2-2' }}%
              </div>
            </div>
            <div class="row highlight">
              <div class="col left-align" style="font-weight: bold">
                After-Tax Cost of Debt
              </div>
              <div class="col-3 right-align" style="font-weight: bold">
                {{
                dcf.waac_calculations?.after_tax_debt_cost * 100
                | number: '1.2-2'
                }}
                %
              </div>
            </div>
  
            <div class="row highlight">
              <div class="col left-align" style="font-weight: bold">WACC</div>
              <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                <ng-template [ngIf]="i == 5">
                  <div class="col-3 right-align" style="font-weight: bold; width: 475px">
                    <ng-template [ngIf]="rev['wacc'] >= 0">
                      {{ rev['wacc'] | number: '1.2-2' }}%
                    </ng-template>
                    <ng-template [ngIf]="rev['wacc'] < 0">
                      ({{ -rev['wacc'] | number: '1.2-2' }}%)
                    </ng-template>
                    <mat-icon style="display: inline; margin: auto 5px; cursor: pointer" (click)="openPopUpModal(wacc)">
                      edit</mat-icon>
                  </div>
                </ng-template>
              </ng-template>
            </div>
  
            <div class="row headers" style="
                font-weight: bold;
                background-color: #164a5b;
                color: white;
                padding: 5px 15px;
                font-weight: normal;
                border-top-left-radius: 5px;
                border-top-right-radius: 5px;
              ">
              Assumptions
            </div>
  
            <div class="row" style="background: white">
              <div class="col left-align">Corporate Tax Rate</div>
              <div class="col-3 right-align"> {{ corpTaxRate | number:"1.2-2"}} %
                <mat-icon style="display: inline; margin: auto 5px; cursor: pointer" (click)="openPopUpModal(costOfDebt)">
                  edit</mat-icon>
              </div>
            </div>
            <div class="row" style="background: white">
              <div class="col left-align">EBITDA Exit Multiple</div>
              <div class="col-3 right-align">
                40x
                <mat-icon style="display: inline; margin: auto 5px; cursor: pointer"
                  (click)="openPopUpModal(costOfDebt)">edit</mat-icon>
              </div>
            </div>
            <div class="row highlight">
              <div class="col left-align" style="font-weight: bold">
                After-Tax Cost of Debt
              </div>
              <div class="col-3 right-align" style="font-weight: bold">
                {{
                dcf.waac_calculations?.after_tax_debt_cost * 100
                | number: '1.2-2'
                }}
                %
              </div>
            </div>
          </div>
  
          <div class="col-8" style="background: white; padding-left: 10px;
          max-width: 60%;
          margin: 10px 20px;"
            *ngIf="dcf.data && dcf.data.length > 0">
            <div class="row headers" style="
                font-weight: bold;
                background-color: #164a5b;
                color: white;
                padding: 5px;
                font-weight: normal;
                border-top-left-radius: 5px;
                border-top-right-radius: 5px;
              ">
              <div class="col-2 left-align" style="border-bottom: 0px">
                Ticker
              </div>
              <div class="col-2 reduced-width left-align" style="border-bottom: 0px">
                Company
              </div>
              <div class="col-2 right-align" style="border-bottom: 0px">
                Levered Beta
              </div>
              <div class="col-2 right-align" style="border-bottom: 0px">
                Debt/Equity
              </div>
              <div class="col-2 right-align" style="border-bottom: 0px">
                Tax Rate
              </div>
              <div class="col-2 right-align" style="border-bottom: 0px">
                Unlevered Beta
              </div>
            </div>
  
            <ng-template ngFor [ngForOf]="dcf.data" let-comp let-rowIndex="index">
              <div class="row">
                <div class="col-2 left-align">
                  {{ comp?.ticker }}
                </div>
                <div class="col left-align">
                  {{ comp?.company }}
                </div>
                <div class="col-2 right-align">
                  {{ comp?.levered_beta | number: '1.2-2' }}
                </div>
                <div class="col-2 right-align">
                  {{ comp?.debt_equity | number: '1.1-2' }}%
                </div>
                <div class="col-2 right-align">
                  {{ comp?.tax_rate | number: '1.2-2' }}%
                </div>
                <div class="col-2 right-align">
                  {{ comp?.unlevered_beta | number: '1.2-2' }}
                </div>
              </div>
            </ng-template>
  
            <div class="row highlight" style="font-weight: bold">
              <div class="col-2 left-align">Median</div>
              <div class="col 2 left-align"></div>
              <div class="col-2 right-align">
                {{ dcf.median?.levered_beta | number: '1.2-2' }}
              </div>
              <div class="col-2 right-align">
                {{ dcf?.median?.debt_equity | number: '1.1-2' }}%
              </div>
              <div class="col-2 right-align"></div>
              <div class="col-2 right-align">
                {{ dcf.median?.unlevered_beta | number: '1.2-2' }}
              </div>
            </div>
          </div>
        </div>
    </div>

    <div class="valuations" style="margin-top: 60px;" fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="20px" id="myTable">
        <div fxFlex="100">
          <!-- <mat-progress-bar mode="indeterminate" *ngIf="progressBar"></mat-progress-bar> -->
    
          <div class="mat-elevation-z8" style="box-shadow: none;" #unleveredFreeCashFlow>
            <div>
              <th style="
                  font-weight: bold;
                  background-color: #164a5b;
                  color: white;
                  padding: 18px 15px;
                  font-weight: normal;
                  border-top-left-radius: 5px;
                  width: 5000px;
                  border-top-right-radius: 5px;
                ">
                Unlevered Free Cash Flow Profile
              </th>
    
              <table class="table table-striped">
                <tr style="height: 35px">
                  <th class="tableheaderClass leftAlign" style="font-weight: normal">
                    (in millions)
                  </th>
                  <th class="tableheaderClass rightAlign" style="font-style: normal">
                    Total
                  </th>
                  <ng-template ngFor [ngForOf]="years" let-year let-rowIndex="index">
                    <ng-template [ngIf]="rowIndex <= years.length - 3" [ngIfElse]="actualYear">
                      <th class="tableheaderYearClass rightAlign" [class.borderRadius]="rowIndex == years.length - 1">
                        <ng-template [ngIf]="year.indexOf('-') >= 0" [ngIfElse]="actualYear">
                          Total
                        </ng-template>
                        <ng-template #actualYear>
                          {{ year }}
                        </ng-template>
                      </th>
                    </ng-template>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">EBITDA</td>
                  <td class="normalClass rightAlign">
                    $ {{ financials[5]?.EBITDA | number: '1.0-0' }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="normalClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['EBITDA'] >= 0">
                        $ {{ rev['EBITDA'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['EBITDA'] < 0">
                        ($ {{ -rev['EBITDA'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">
                    (–) Depreciation & Amortization
                  </td>
                  <td class="normalClass rightAlign">
                    $
                    {{ financials[5]?.DepreciationAmortization | number: '1.0-0' }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="normalClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['DepreciationAmortization'] >= 0">
                        $ {{ rev['DepreciationAmortization'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['DepreciationAmortization'] < 0">
                        ($ {{ -rev['DepreciationAmortization'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
                <tr>
                  <td class="tableboldClass leftAlign">EBIT</td>
                  <td class="tableboldClass rightAlign">
                    $ {{ financials[5]?.EBIT | number: '1.0-0' }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="tableboldClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['EBIT'] >= 0">
                        $ {{ rev['EBIT'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['EBIT'] < 0">
                        ($ {{ -rev['EBIT'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">(+/–) Net Interest Expense</td>
                  <td class="normalClass rightAlign">
                    <ng-template [ngIf]="
                        financials[5] && financials[5]?.NetInterestExpense >= 0
                      ">
                      ${{ financials[5].NetInterestExpense | number: '1.0-0' }}
                    </ng-template>
                    <ng-template [ngIf]="
                        financials[5] && financials[5]?.NetInterestExpense < 0
                      ">
                      (${{ -financials[5].NetInterestExpense | number: '1.0-0' }})
                    </ng-template>
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="normalClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['NetInterestExpense'] >= 0">
                        $ {{ rev['NetInterestExpense'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['NetInterestExpense'] < 0">
                        ($ {{ -rev['NetInterestExpense'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="tableboldClass">EBT</td>
                  <td class="tableboldClass rightAlign">
                    $ {{ financials[5]?.EBT | number: '1.0-0' }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="tableboldClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['EBT'] >= 0">
                        $ {{ rev['EBT'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['EBT'] < 0">
                        ($ {{ -rev['EBT'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">(–) NOLs Utilized</td>
                  <td class="normalClass rightAlign">
                    $ {{ financials[5]?.NOLsUtilized | number: '1.0-0' }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="normalClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['NOLsUtilized'] >= 0">
                        $ {{ rev['NOLsUtilized'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['NOLsUtilized'] < 0">
                        ($ {{ -rev['NOLsUtilized'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="tableboldClass leftAlign">EBT Post NOL Utilization</td>
                  <td class="normalClass rightAlign">
                    $ {{ financials[5]?.EBTPostNOLUtilization | number: '1.0-0' }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="tableboldClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['EBTPostNOLUtilization'] >= 0">
                        $ {{ rev['EBTPostNOLUtilization'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['EBTPostNOLUtilization'] < 0">
                        ($ {{ -rev['EBTPostNOLUtilization'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">(–) Cash Taxes</td>
    
                  <td class="normalClass rightAlign">
                    <ng-template [ngIf]="financials[5] && financials[5]?.CashTaxes >= 0">
                      ${{ financials[5]?.CashTaxes | number: '1.0-0' }}
                    </ng-template>
                    <ng-template [ngIf]="financials[5] && financials[5]?.CashTaxes < 0">
                      (${{ -financials[5]?.CashTaxes | number: '1.0-0' }})
                    </ng-template>
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="normalClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['CashTaxes'] >= 0">
                        $ {{ rev['CashTaxes'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['CashTaxes'] < 0">
                        ($ {{ -rev['CashTaxes'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="tableboldClass leftAlign">
                    Earnings Before Interest After Taxes (EBIAT)
                  </td>
                  <td class="tableboldClass rightAlign">
                    <ng-template [ngIf]="
                        financials[5] &&
                        financials[5]?.EarningsBeforeInterestAfterTaxes >= 0
                      ">
                      $
                      {{
                      financials[5]?.EarningsBeforeInterestAfterTaxes
                      | number: '1.0-0'
                      }}
                    </ng-template>
                    <ng-template [ngIf]="
                        financials[5] &&
                        financials[5]?.EarningsBeforeInterestAfterTaxes < 0
                      ">
                      (${{
                      -financials[5]?.EarningsBeforeInterestAfterTaxes
                      | number: '1.0-0'
                      }})
                    </ng-template>
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="tableboldClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['EarningsBeforeInterestAfterTaxes'] >= 0">
                        $
                        {{
                        rev['EarningsBeforeInterestAfterTaxes'] | number: '1.0-0'
                        }}
                      </ng-template>
                      <ng-template [ngIf]="rev['EarningsBeforeInterestAfterTaxes'] < 0">
                        ($
                        {{
                        -rev['EarningsBeforeInterestAfterTaxes']
                        | number: '1.0-0'
                        }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">
                    (+) Depreciation & Amortization
                  </td>
                  <td class="normalClass rightAlign">
                    <ng-template [ngIf]="financials[5] && financials[5]?.DA >= 0">
                      ${{ financials[5].DA | number: '1.0-0' }}
                    </ng-template>
                    <ng-template [ngIf]="financials[5] && financials[5]?.DA < 0">
                      (${{ -financials[5].DA | number: '1.0-0' }})
                    </ng-template>
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="normalClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['DA'] >= 0">
                        $ {{ rev['DA'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['DA'] < 0">
                        ($ {{ -rev['DA'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">(–) Capex</td>
                  <td class="normalClass rightAlign">
                    <ng-template [ngIf]="financials[5] && financials[5]?.Capex >= 0">
                      ${{ financials[5].Capex | number: '1.0-0' }}
                    </ng-template>
                    <ng-template [ngIf]="financials[5] && financials[5]?.Capex < 0">
                      (${{ -financials[5].Capex | number: '1.0-0' }})
                    </ng-template>
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="normalClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['Capex'] >= 0">
                        $ {{ rev['Capex'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['Capex'] < 0">
                        ($ {{ -rev['Capex'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">
                    (+/–) Change in Net Working Capital
                  </td>
                  <td class="normalClass rightAlign">
                    <ng-template [ngIf]="
                        financials[5] &&
                        financials[5]?.ChangeinNetWorkingCapital >= 0
                      ">
                      ${{
                      financials[5].ChangeinNetWorkingCapital | number: '1.0-0'
                      }}
                    </ng-template>
                    <ng-template [ngIf]="
                        financials[5] &&
                        financials[5]?.ChangeinNetWorkingCapital < 0
                      ">
                      (${{
                      -financials[5].ChangeinNetWorkingCapital | number: '1.0-0'
                      }})
                    </ng-template>
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="normalClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['ChangeinNetWorkingCapital'] >= 0">
                        $ {{ rev['ChangeinNetWorkingCapital'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['ChangeinNetWorkingCapital'] < 0">
                        ($
                        {{ -rev['ChangeinNetWorkingCapital'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="tableboldClass leftAlign">Unlevered Free Cash Flow</td>
                  <td class="tableboldClass rightAlign">
                    $ {{ financials[5]?.UnleveredFreeCashFlow | number: '1.0-0' }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-rowIndex="index">
                    <td class="tableboldClass rightAlign" *ngIf="rowIndex <= years.length - 3">
                      <ng-template [ngIf]="rev['UnleveredFreeCashFlow'] >= 0">
                        $ {{ rev['UnleveredFreeCashFlow'] | number: '1.0-0' }}
                      </ng-template>
                      <ng-template [ngIf]="rev['UnleveredFreeCashFlow'] < 0">
                        ($ {{ -rev['UnleveredFreeCashFlow'] | number: '1.0-0' }})
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
              </table>
            </div>
          </div>
        </div>
    </div>

    <div class="valuations" style="margin-top: 60px;" fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="20px" id="myTable">
        <div fxFlex="100">
          <mat-progress-bar mode="indeterminate" *ngIf="progressBar"></mat-progress-bar>
          <div class="mat-elevation-z8" style="box-shadow: none;" #valuations>
            <div>
              <th style="
                  font-weight: bold;
                  background-color: #164a5b;
                  color: white;
                  padding: 18px 15px;
                  font-weight: normal;
                  border-top-left-radius: 5px;
                  width: 5000px;
                  border-top-right-radius: 5px;
                ">
                Valuations
              </th>
    
              <table class="table table-striped">
                <tr style="height: 35px">
                  <th class="tableheaderClass leftAlign" style="font-weight: normal">
                    (in millions)
                  </th>
                  <th class="tableheaderClass rightAlign" style="font-style: normal">
                    Total
                  </th>
                  <ng-template ngFor [ngForOf]="years" let-year let-rowIndex="index">
                    <ng-template [ngIf]="rowIndex != 5">
                      <th class="tableheaderYearClass rightAlign" style="border-top-right-radius: 0px"
                        [class.borderRadius]="rowIndex == years.length - 1">
                        <ng-template [ngIf]="year.indexOf('-') >= 0" [ngIfElse]="ActualYear">
                          Total
                        </ng-template>
    
                        <ng-template #ActualYear>
                          <ng-template [ngIf]="rowIndex != 6">
                            {{ year }}
                          </ng-template>
                          <ng-template [ngIf]="rowIndex == 6">
                            Terminal
                          </ng-template>
                        </ng-template>
                      </th>
                    </ng-template>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">Period</td>
                  <td class="normalClass rightAlign"></td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <ng-template [ngIf]="i != 5">
                      <td class="normalClass rightAlign">
                        <ng-template [ngIf]="rev['Period'] >= 0">
                          {{ rev['Period'] }}
                        </ng-template>
                        <ng-template [ngIf]="rev['Period'] < 0">
                          ( {{ -Period }})
                        </ng-template>
                      </td>
                    </ng-template>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">
                    Discount Factor (Mid-Year Convention)
                  </td>
                  <td class="normalClass rightAlign"></td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <ng-template [ngIf]="i != 5">
                      <td class="normalClass rightAlign">
                        <ng-template [ngIf]="rev['DiscountFactor'] >= 0">
                          {{ rev['DiscountFactor'] | number: '1.0-0' }}%
                        </ng-template>
                        <ng-template [ngIf]="rev['DiscountFactor'] < 0">
                          ( {{ -rev['DiscountFactor'] | number: '1.0-0' }}%)
                        </ng-template>
                      </td>
                    </ng-template>
                  </ng-template>
                </tr>
                <tr>
                  <td class="normalClass leftAlign">Present Value of FCFs</td>
                  <td class="normalClass rightAlign">
                    $
                    {{
                    financials[0]?.PresentFcf +
                    financials[1]?.PresentFcf +
                    financials[2]?.PresentFcf +
                    financials[3]?.PresentFcf +
                    financials[4]?.PresentFcf | number: '1.0-0'
                    }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <ng-template [ngIf]="i != 5">
                      <td class="normalClass rightAlign">
                        <ng-template [ngIf]="rev['PresentFcf'] >= 0">
                          $ {{ rev['PresentFcf'] | number: '1.0-0' }}
                        </ng-template>
                        <ng-template [ngIf]="rev['PresentFcf'] < 0">
                          ($ {{ -rev['PresentFcf'] | number: '1.0-0' }})
                        </ng-template>
                      </td>
                    </ng-template>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">
                    Present Value of Terminal Value
                  </td>
                  <td class="normalClass rightAlign">
                    $
                    {{
                    (40 * financials[4]?.EBITDA * financials[6]?.DiscountFactor) /
                    100 | number: '1.0-0'
                    }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <ng-template [ngIf]="i != 5 && i != 6">
                      <td class="normalClass rightAlign">
                        <ng-template [ngIf]="rev['PresentTerminalValue'] >= 0">
                          $ {{ rev['PresentTerminalValue'] | number: '1.0-0' }}
                        </ng-template>
                        <ng-template [ngIf]="rev['PresentTerminalValue'] < 0">
                          ($ {{ -rev['PresentTerminalValue'] | number: '1.0-0' }})
                        </ng-template>
                      </td>
                    </ng-template>
                    <ng-template [ngIf]="i == 5">
                      <td class="normalClass rightAlign">
                        $
                        {{
                        (40 *
                        financials[4]?.EBITDA *
                        financials[6]?.DiscountFactor) /
                        100 | number: '1.0-0'
                        }}
                      </td>
                    </ng-template>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="tableboldClass">Total</td>
                  <td class="tableboldClass rightAlign">
                    $
                    {{
                    (40 * financials[4]?.EBITDA * financials[6]?.DiscountFactor) /
                    100 +
                    financials[0]?.PresentFcf +
                    financials[1]?.PresentFcf +
                    financials[2]?.PresentFcf +
                    financials[3]?.PresentFcf +
                    financials[4]?.PresentFcf | number: '1.0-0'
                    }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <ng-template [ngIf]="i != 5 && i != 6">
                      <td class="tableboldClass rightAlign">
                        <ng-template [ngIf]="rev['Total'] >= 0">
                          $ {{ rev['Total'] | number: '1.0-0' }}
                        </ng-template>
                        <ng-template [ngIf]="rev['Total'] < 0">
                          ($ {{ -rev['Total'] | number: '1.0-0' }})
                        </ng-template>
                      </td>
                    </ng-template>
    
                    <ng-template [ngIf]="i == 5">
                      <td class="tableboldClass rightAlign">
                        $
                        {{
                        (40 *
                        financials[4]?.EBITDA *
                        financials[6]?.DiscountFactor) /
                        100 +
                        financials[6]?.PresentFcf | number: '1.0-0'
                        }}
                      </td>
                    </ng-template>
                  </ng-template>
                </tr>
              </table>
            </div>
          </div>
        </div>
    </div>

    <div class="valuations" style="margin-top: 60px;" fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="20px" id="myTable" style="width: 650px">
        <div fxFlex="100">
          <mat-progress-bar mode="indeterminate" *ngIf="progressBar"></mat-progress-bar>
          <div class="mat-elevation-z8" style="box-shadow: none;" #valuationSummary>
            <div>
              <th style="
                  font-weight: bold;
                  background-color: #164a5b;
                  color: white;
                  padding: 18px 15px;
                  font-weight: normal;
                  border-top-left-radius: 5px;
                  border-top-right-radius: 5px;
                  width: 2000px;
                ">
                Valuation Summary
              </th>
    
              <table class="table table-striped">
                <tr style="height: 35px">
                  <th class="tableheaderClass leftAlign" style="font-weight: normal">
                    (in millions)
                  </th>
    
                  <th class="tableheaderClass rightAlign" style="font-style: normal">
                    Total
                  </th>
    
                  <ng-template ngFor [ngForOf]="years" let-year let-rowIndex="index">
                    <ng-template [ngIf]="
                        rowIndex != 2 &&
                        rowIndex != 3 &&
                        rowIndex != 4 &&
                        rowIndex != 6
                      ">
                      <ng-template [ngIf]="rowIndex <= years.length - 3" [ngIfElse]="actualYear">
                        <th class="tableheaderYearClass rightAlign" [class.borderRadius]="rowIndex == years.length - 1">
                          <ng-template [ngIf]="year.indexOf('-') >= 0" [ngIfElse]="actualYear">
                            Total
                          </ng-template>
                          <ng-template #actualYear>
                            {{ year }}E EBITDA <br /><span style="padding-right: 25px">Multi.</span>
                          </ng-template>
                        </th>
                      </ng-template>
                    </ng-template>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">Present Value of FCFs</td>
                  <td class="normalClass rightAlign">
                    $
                    {{
                    financials[0]?.PresentFcf +
                    financials[1]?.PresentFcf +
                    financials[2]?.PresentFcf +
                    financials[3]?.PresentFcf +
                    financials[4]?.PresentFcf | number: '1.0-0'
                    }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <td class="normalClass rightAlign" *ngIf="i == 1 || i == 2">
                      <ng-template [ngIf]="i == 5">
                        <ng-template [ngIf]="rev['PresentFcf'] >= 0">
                          $ {{ rev['PresentFcf'] | number: '1.0-0' }}
                        </ng-template>
                        <ng-template [ngIf]="rev['PresentFcf'] < 0">
                          ($ {{ -rev['PresentFcf'] | number: '1.0-0' }})
                        </ng-template>
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
    
                <tr>
                  <td class="normalClass leftAlign">
                    Present Value of Terminal Value
                  </td>
                  <td class="normalClass rightAlign">
                    $
                    {{
                    (financials[4]?.EBITDA * 40 * financials[6]?.DiscountFactor) /
                    100 | number: '1.0-0'
                    }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <td class="normalClass rightAlign" *ngIf="i == 1 || i == 2">
                      <ng-template [ngIf]="i == 5">
                        <ng-template [ngIf]="
                            (financials[4].EBITDA *
                              40 *
                              financials[6].DiscountFactor) /
                              100 >=
                            0
                          ">
                          $
                          {{
                          (financials[4]?.EBITDA *
                          40 *
                          financials[6]?.DiscountFactor) /
                          100 | number: '1.0-0'
                          }}
                        </ng-template>
                        <ng-template [ngIf]="
                            (financials[4].EBITDA *
                              40 *
                              financials[6].DiscountFactor) /
                              100 <
                            0
                          ">
                          ($
                          {{
                          -(
                          (financials[4]?.EBITDA *
                          40 *
                          financials[6]?.DiscountFactor) /
                          100
                          ) | number: '1.0-0'
                          }})
                        </ng-template>
                      </ng-template>
                    </td>
                  </ng-template>
                  <!-- <td class="tableboldClass rightAlign" *ngFor="let rev of financials">
                                  <ng-template [ngIf]="rev['PresentTerminalValue'] >= 0">
                                      $ {{ rev['PresentTerminalValue'] | number: '1.0-0'}}
                                  </ng-template>
                                  <ng-template [ngIf]="rev['PresentTerminalValue'] < 0">
                                      ($ {{ -(rev['PresentTerminalValue']) | number: '1.0-0'}})
                                  </ng-template>
                              </td> -->
                </tr>
    
                <tr>
                  <td class="tableboldClass">Total Enterprise Value</td>
                  <td class="tableboldClass rightAlign">
                    $
                    {{
                    financials[0]?.PresentFcf +
                    financials[1]?.PresentFcf +
                    financials[2]?.PresentFcf +
                    financials[3]?.PresentFcf +
                    financials[4]?.PresentFcf +
                    (financials[4]?.EBITDA *
                    40 *
                    financials[6]?.DiscountFactor) /
                    100 | number: '1.0-0'
                    }}
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <ng-template [ngIf]="i != 2 && i != 3 && i != 4 && i != 5 && i != 6">
                      <td class="tableboldClass rightAlign">
                        <ng-template [ngIf]="i == 0">
                          <ng-template [ngIf]="
                              (financials[0].PresentFcf +
                                financials[1].PresentFcf +
                                financials[2].PresentFcf +
                                financials[3].PresentFcf +
                                financials[4].PresentFcf +
                                (financials[4].EBITDA *
                                  40 *
                                  financials[6].DiscountFactor) /
                                  100) /
                                financials[0].EBITDA >=
                              0
                            ">
                            {{
                            (financials[0].PresentFcf +
                            financials[1].PresentFcf +
                            financials[2].PresentFcf +
                            financials[3].PresentFcf +
                            financials[4].PresentFcf +
                            (financials[4].EBITDA *
                            40 *
                            financials[6].DiscountFactor) /
                            100) /
                            financials[0].EBITDA | number: '1.0-0'
                            }}x
                          </ng-template>
                          <ng-template [ngIf]="
                              financials[0].PresentFcf +
                                financials[1].PresentFcf +
                                financials[2].PresentFcf +
                                financials[3].PresentFcf +
                                financials[4].PresentFcf +
                                (financials[4].EBITDA *
                                  40 *
                                  financials[6].DiscountFactor) /
                                  100 /
                                  financials[0].EBITDA <
                              0
                            ">
                            (
                            {{
                            -(
                            financials[0].PresentFcf +
                            financials[1].PresentFcf +
                            financials[2].PresentFcf +
                            financials[3].PresentFcf +
                            financials[4].PresentFcf +
                            (financials[4].EBITDA *
                            40 *
                            financials[6].DiscountFactor) /
                            100 /
                            financials[0].EBITDA
                            ) | number: '1.0-0'
                            }}x)
                          </ng-template>
                        </ng-template>
                        <ng-template [ngIf]="i == 1">
                          <ng-template [ngIf]="
                              (financials[0].PresentFcf +
                                financials[1].PresentFcf +
                                financials[2].PresentFcf +
                                financials[3].PresentFcf +
                                financials[4].PresentFcf +
                                (financials[4].EBITDA *
                                  40 *
                                  financials[6].DiscountFactor) /
                                  100) /
                                financials[1].EBITDA >=
                              0
                            ">
                            {{
                            (financials[0].PresentFcf +
                            financials[1].PresentFcf +
                            financials[2].PresentFcf +
                            financials[3].PresentFcf +
                            financials[4].PresentFcf +
                            (financials[4].EBITDA *
                            40 *
                            financials[6].DiscountFactor) /
                            100) /
                            financials[1].EBITDA | number: '1.0-0'
                            }}x
                          </ng-template>
                          <ng-template [ngIf]="
                              financials[0].PresentFcf +
                                financials[1].PresentFcf +
                                financials[2].PresentFcf +
                                financials[3].PresentFcf +
                                financials[4].PresentFcf +
                                (financials[4].EBITDA *
                                  40 *
                                  financials[6].DiscountFactor) /
                                  financials[1].EBITDA <
                              0
                            ">
                            (
                            {{
                            -(
                            financials[0].PresentFcf +
                            financials[1].PresentFcf +
                            financials[2].PresentFcf +
                            financials[3].PresentFcf +
                            financials[4].PresentFcf +
                            (financials[4].EBITDA *
                            40 *
                            financials[6].DiscountFactor) /
                            financials[1].EBITDA /
                            100
                            ) | number: '1.0-0'
                            }}x)
                          </ng-template>
                        </ng-template>
                      </td>
                    </ng-template>
                  </ng-template>
                  <!-- <td class="normalClass rightAlign" *ngFor="let rev of financials">
                                  <ng-template [ngIf]="rev['Total'] >= 0">
                                      $ {{ rev['Total'] | number: '1.0-0'}}
                                  </ng-template>
                                  <ng-template [ngIf]="rev['Total'] < 0">
                                      ($ {{ -(rev['Total']) | number: '1.0-0'}})
                                  </ng-template>
                              </td> -->
                </tr>
    
                <tr>
                  <td class="normalClass">(–) Current Net Debt</td>
                  <td class="normalClass rightAlign">
                    <ng-template [ngIf]="financials[5] && financials[5]?.current >= 0">
                      $ {{ financials[5].current | number: '1.0-0' }}
                    </ng-template>
                    <ng-template [ngIf]="financials[5] && financials[5]?.current < 0">
                      (${{ -financials[5].current | number: '1.0-0' }})
                    </ng-template>
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <td class="normalClass rightAlign" *ngIf="i == 1 || i == 2">
                      <ng-template [ngIf]="i == 5">
                        <ng-template [ngIf]="rev['current'] >= 0">
                          $ {{ rev['current'] | number: '1.0-0' }}
                        </ng-template>
                        <ng-template [ngIf]="rev['current'] < 0">
                          ($ {{ -rev['current'] | number: '1.0-0' }})
                        </ng-template>
                      </ng-template>
                    </td>
                  </ng-template>
    
                  <!-- <td class="normalClass rightAlign" *ngFor="let rev of financials">
                                  <ng-template [ngIf]="rev['Total'] >= 0">
                                      $ {{ rev['Total'] | number: '1.0-0'}}
                                  </ng-template>
                                  <ng-template [ngIf]="rev['Total'] < 0">
                                      ($ {{ -(rev['Total']) | number: '1.0-0'}})
                                  </ng-template>
                              </td> -->
                </tr>
    
                <tr>
                  <td class="tableboldClass">Equity Value</td>
                  <td class="normalClass rightAlign">
                    <ng-template [ngIf]="
                        (financials[0]?.PresentFcf +
                          financials[1]?.PresentFcf +
                          financials[2]?.PresentFcf +
                          financials[3]?.PresentFcf +
                          financials[4]?.PresentFcf +
                          financials[4]?.EBITDA *
                            40 *
                            financials[6]?.DiscountFactor +
                          financials[5]?.current) /
                          100 >=
                        0
                      ">
                      $
                      {{
                      (financials[0]?.PresentFcf +
                      financials[1]?.PresentFcf +
                      financials[2]?.PresentFcf +
                      financials[3]?.PresentFcf +
                      financials[4]?.PresentFcf +
                      financials[4]?.EBITDA *
                      40 *
                      financials[6]?.DiscountFactor +
                      financials[5]?.current) /
                      100 | number: '1.0-0'
                      }}
                    </ng-template>
                    <ng-template [ngIf]="
                        (financials[0]?.PresentFcf +
                          financials[1]?.PresentFcf +
                          financials[2]?.PresentFcf +
                          financials[3]?.PresentFcf +
                          financials[4]?.PresentFcf +
                          financials[4]?.EBITDA *
                            40 *
                            financials[6]?.DiscountFactor +
                          financials[5]?.current) /
                          100 <
                        0
                      ">
                      ($
                      {{
                      -(
                      financials[0]?.PresentFcf +
                      financials[1]?.PresentFcf +
                      financials[2]?.PresentFcf +
                      financials[3]?.PresentFcf +
                      financials[4]?.PresentFcf +
                      financials[4]?.EBITDA *
                      40 *
                      financials[6]?.DiscountFactor +
                      financials[5]?.current
                      ) / 100 | number: '1.0-0'
                      }})
                    </ng-template>
                  </td>
                  <ng-template ngFor [ngForOf]="financials" let-rev let-i="index">
                    <td class="tableboldClass rightAlign" *ngIf="i == 1 || i == 2">
                      <ng-template [ngIf]="i == 5">
                        <ng-template [ngIf]="rev['equity'] >= 0">
                          $ {{ rev['equity'] | number: '1.0-0' }}
                        </ng-template>
                        <ng-template [ngIf]="rev['equity'] < 0">
                          ($ {{ -rev['equity'] | number: '1.0-0' }})
                        </ng-template>
                      </ng-template>
                    </td>
                  </ng-template>
                </tr>
              </table>
            </div>
          </div>
        </div>
    </div>
</ng-template>

<ng-template [ngIf]="showCoverImage">
  <img id='imgToExport' style="border: none; box-shadow: none; margin-top: 100px;" #imagecover src='../../../assets/images/Report_logo.jpg'>
</ng-template>

<ng-template [ngIf]="showOrganizationalLogo && organizationLogo">
  <img id='imgToExport' style="border: none; box-shadow: none; margin-top: 100px;"  height="450" width="600"  #imageOrganizational [src]='organizationLogo'>
</ng-template>


<ng-template [ngIf]="showValuations">
  <div class="content score-card"  style="width:100%;text-align:center; margin-top: 100px;">
      <div class=" row" #creditScoreCard>
          <div class=" col-md-12">
              <div class=" card" >
                  <div style="border-radius:25px">
                              </div>
                  <div class=" card-body" style="padding: 0px">
  
                      <table class=" table tablesorter">
                          <thead>
                              <tr style="color:black;">
  
                              </tr>
                              <tr style="background:#164a5b;color:white;text-align:center;margin:0px;vertical-align:middle;border-top-left-radius:5px;border-top-right-radius:5px;height:50px;padding-top:10px;font-weight:bold">
                                  <td ></td>
                                  <td style="width:190px;font-style:italic;font-weight:bold">Actuals</td>
                                  <td style="width:140px;font-weight:bold">1.0<br/><span style="font-style:italic;font-weight:bold">(Poor)</span></td>
                                  <td style="width:140px;font-weight:bold">2.0<br/><span style="font-style:italic;font-weight:bold">(Below Average)</span></td>
                                  <td style="width:140px;font-weight:bold">3.0<br/><span style="font-style:italic;font-weight:bold">(Average)</span></td>
                                  <td style="width:140px;font-weight:bold">4.0<br/><span style="font-style:italic;font-weight:bold">(Above Average)</span></td>
                                  <td style="width:140px;font-weight:bold">5.0<br/><span style="font-style:italic;font-weight:bold">(Exceptional)</span></td>
                                  <td style="width:100px;font-weight:bold">Factor<br />Score</td>
                                  <td style="width:100px;font-weight:bold">Factor<br />Weight</td>
                              </tr>
  
  
                              <tr>
                                  <td class="left" style="vertical-align:middle"> <b>I) Historical Revenue CAGR</b> <span style="font-style:italic"> (Last 3 years)</span>
                                  </td>
                                  <td style="font-style:italic">{{scoreCardData1?.revenuecagr | number: '1.1-1'}}%</td>
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.revenuecagr)"> < 0.0%</td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.revenuecagr)">0.0% - 2.5% </td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.revenuecagr)">2.5% - 5.0% </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.revenuecagr)">5.0% - 10.0% </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.revenuecagr)"> > 10.0%
                                  </td>
                                  <td> {{scoreCardData?.revenuecagr | number: '1.1-1'}} </td>
                                  <td>{{scoreCardData?.factorweight | number: '1.1-1'}}%</td>
                              </tr>
  
                              <tr style="border-collapse: separate">
                                  <td class="left" style="vertical-align:middle">
                                      <b>II) Historical Gross Margins</b> <span style="font-style:italic"> (Avg. of last 3 years)</span>
                                  </td>
                                  <td style="font-style:italic">{{scoreCardData1?.avggrossmargin | number: '1.1-1'}}%</td>
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.avggrossmargin)">0.0% - 10.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.avggrossmargin)">10.0% - 20.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.avggrossmargin)">20.0% - 30.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.avggrossmargin)"> 30.0% - 40.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.avggrossmargin)"> > 40.0%
                                  </td>
                                  <td> {{scoreCardData?.avggrossmargin | number: '1.1-1'}} </td>
                                  <td>{{scoreCardData?.factorweight | number: '1.1-1'}}%</td>
                              </tr>
                              <tr>
  
                                  <td class="left" style="vertical-align:middle"> <b>III)  Historical EBITDA Margins</b> <span style="font-style:italic"> (Avg. of last
                                      3 years)</span></td>
                                  <td style="font-style:italic"> {{scoreCardData1?.avgebitdamargin | number: '1.1-1'}}%</td>
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.avgebitdamargin)">
                                      < 5.0% </td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.avgebitdamargin)">5.0% - 10.0% </td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.avgebitdamargin)"> 10.0% - 15.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.avgebitdamargin)">15.0% - 20.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.avgebitdamargin)"> > 20.0%
                                  </td>
                                  <td>{{scoreCardData?.avgebitdamargin | number: '1.1-1'}} </td>
                                  <td>{{scoreCardData?.factorweight | number: '1.1-1'}}%</td>
                              </tr>
                              <tr>
  
                                  <td class="left" style="vertical-align:middle"><b> IV) Historical EBITDA CAGR</b> <span style="font-style:italic"> (Last 3 years)</span>
                                  </td>
                                  <td style="font-style:italic"> {{scoreCardData1?.ebitdacagr | number: '1.1-1'}}%</td>
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.ebitdacagr)">
                                      < 0.0% </td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.ebitdacagr)">0.0% - 2.5%
                                  </td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.ebitdacagr)">2.5% - 5.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.ebitdacagr)">5.0 - 10.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.ebitdacagr)"> > 10.0
                                  </td>
                                  <td>{{scoreCardData?.ebitdacagr | number: '1.1-1'}} </td>
                                  <td>{{scoreCardData?.factorweight | number: '1.1-1'}}%</td>
                              </tr>
  
                              <tr>
  
                                  <td class="left" style="vertical-align:middle"> <b>V) Total Debt-to-EBITDA</b><span style="font-style:italic"> (Last historical
                                      year)</span>
                                  </td>
                                  <td style="font-style:italic"> {{scoreCardData1?.totaldebtebitda | number: '1.1-1'}}x</td>
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.totaldebtebitda)">> 5.0x
                                  </td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.totaldebtebitda)"> 4.0x - 5.0x
                                  </td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.totaldebtebitda)"> 3.0x - 4.0x
                                  </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.totaldebtebitda)">2.0x - 3.0x
                                  </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.totaldebtebitda)">
                                      < 2.0x </td>
                                  <td>{{scoreCardData?.totaldebtebitda | number: '1.1-1'}} </td>
                                  <td>{{scoreCardData?.factorweight | number: '1.1-1'}}%</td>
                              </tr>
                              <tr>
  
                                  <td class="left" style="vertical-align:middle"><b>VI) Current Ratio</b> <span style="font-style:italic"> (Last historical year)</span>
                                  </td>
                                  <td style="font-style:italic"> {{scoreCardData1?.currentratio | number: '1.1-1'}}x</td>
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.currentratio)">
                                      < 0.5x</td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.currentratio)">0.5x - 1.0x</td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.currentratio)"> 1.0x - 1.5x
                                  </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.currentratio)">1.5x - 2.0x
                                  </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.currentratio)"> > 2.0x
                                  </td>
                                  <td>{{scoreCardData?.currentratio | number: '1.1-1'}} </td>
                                  <td>{{scoreCardData?.factorweight | number: '1.1-1'}}%</td>
                              </tr>
                              <tr>
  
                                  <td class="left" style="vertical-align:middle"><b>VII) Capex as % of Revenue</b> <span style="font-style:italic"> (Avg. of last 2
                                      years)</span></td>
                                  <td style="font-style:italic">{{scoreCardData1?.capexpercent | number: '1.1-1'}}%</td>
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.capexpercent)"> > 20.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.capexpercent)">15.0% - 20.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.capexpercent)">10.0% - 15.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.capexpercent)">5.0% - 10.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.capexpercent)">
                                      < 5.0% </td>
                                  <td>{{scoreCardData?.capexpercent | number: '1.1-1'}} </td>
                                  <td>{{scoreCardData?.factorweight | number: '1.1-1'}}%</td>
                              </tr>
  
                              <tr>
  
                                  <td class="left" style="vertical-align:middle"><b>VIII) Return on Assets </b> <span style="font-style:italic"> (Last historical year)</span>
                                  </td>
                                  <td style="font-style:italic"> {{scoreCardData1?.returnassets | number: '1.1-1'}}%</td>
  
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.returnassets)">
                                      < 2.0% </td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.returnassets)">2.0% - 4.0% </td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.returnassets)">4.0% - 6.0% </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.returnassets)"> 6.0% - 8.0% </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.returnassets)"> > 8.0%
                                  </td>
                                  <td> {{scoreCardData?.returnassets | number: '1.1-1'}} </td>
                                  <td> {{scoreCardData?.factorweight | number: '1.1-1'}}% </td>
  
                              </tr>
  
                              <tr>
  
                                  <td class="left" style="vertical-align:middle"><b> IX) Return on Equity</b> <span style="font-style:italic"> (Last historical year)</span>
                                  </td>
                                  <td style="font-style:italic">{{scoreCardData1?.returnequity | number: '1.1-1'}}%</td>
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.returnequity)">
                                      < 5.0% </td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.returnequity)">5.0% - 10.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.returnequity)">10.0% - 15.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.returnequity)"> 15.0% - 20.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.returnequity)"> > 20.0%
                                  </td>
                                  <td> {{scoreCardData?.returnequity | number: '1.1-1'}} </td>
                                  <td> {{scoreCardData?.factorweight | number: '1.1-1'}}% </td>
                              </tr>
  
  
                              <tr >
  
                                  <td class="left" style="vertical-align:middle"><b> X) Solvency Ratio</b> <span style="font-style:italic"> (Avg. of last 2 years)</span>
                                  </td>
                                  <td style="font-style:italic">{{scoreCardData1?.solvencyratio | number: '1.1-1'}}%</td>
  
                                  <td [class.highlight]="isInSegment(1, scoreCardData?.solvencyratio)">
                                      < 5.0% </td>
                                  <td [class.highlight]="isInSegment(2, scoreCardData?.solvencyratio)">5.0% - 10.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(3, scoreCardData?.solvencyratio)">10.0% - 15.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(4, scoreCardData?.solvencyratio)"> 15.0% - 20.0%
                                  </td>
                                  <td [class.highlight]="isInSegment(5, scoreCardData?.solvencyratio)"> > 20.0%
                                  </td>
                                  <td> {{scoreCardData?.solvencyratio | number: '1.1-1'}} </td>
                                  <td> {{scoreCardData?.factorweight | number: '1.1-1'}}% </td>
                              </tr>
                              <tr style="border:3px dashed black;background:light-blue">
  
                                  <td class="left border-left-top-bottom" colspan="3" style="vertical-align:middle;font-weight:bold"> RMI Insights Proprietary Overall Financial Health Score
  
                                  </td>
                                  
                                  <td class=" border-top-bottom" ></td>
                                  <td class=" border-top-bottom"></td>
                                  <td class=" border-top-bottom" ></td>
                                  <td class=" border-top-bottom" ></td>
                                  <td class=" border-top-bottom" style="font-weight:bold;"> {{sumProduct | number: '1.1-1'}} </td>
                                  <td class=" border-right-top-bottom"style="font-weight:bold;"> {{scoreCardData?.factorweight*10 | number: '1.1-1'}}% </td>
                              </tr>
                              
                              
                              
                              
                          </thead>
                      </table>
                  </div>
              </div>
          </div>
      </div>
  </div>

</ng-template>



